import 'package:flutter/material.dart';
import '../core/app_theme.dart';
import '../services/app_mode_store.dart';
import 'mode_select_screen.dart';

import '../features/industrial/screens/line_stop_screen.dart';
import '../features/industrial/screens/diagnosis_screen.dart';
import '../features/industrial/screens/knowledge_base_screen.dart';
import '../features/industrial/screens/checklists_screen.dart';

class IndustrialHomeScreen extends StatelessWidget {
  const IndustrialHomeScreen({super.key});

  Future<void> _switchMode(BuildContext context) async {
    await AppModeStore.clear();
    if (!context.mounted) return;
    Navigator.of(context).pushReplacement(
      MaterialPageRoute(builder: (_) => const ModeSelectScreen()),
    );
  }

  void _go(BuildContext context, Widget screen) {
    Navigator.of(context).push(MaterialPageRoute(builder: (_) => screen));
  }

  Widget _tile({
    required BuildContext context,
    required IconData icon,
    required String title,
    required String subtitle,
    required VoidCallback onTap,
  }) {
    return InkWell(
      onTap: onTap,
      borderRadius: BorderRadius.circular(18),
      child: Container(
        margin: const EdgeInsets.only(bottom: 10),
        padding: const EdgeInsets.all(14),
        decoration: BoxDecoration(
          color: AppTheme.card,
          borderRadius: BorderRadius.circular(18),
          border: Border.all(color: AppTheme.border.withOpacity(.35)),
        ),
        child: Row(
          children: [
            Container(
              width: 44,
              height: 44,
              decoration: BoxDecoration(
                color: AppTheme.gold.withOpacity(.12),
                borderRadius: BorderRadius.circular(14),
                border: Border.all(color: AppTheme.gold.withOpacity(.35)),
              ),
              child: Icon(icon, color: AppTheme.gold),
            ),
            const SizedBox(width: 12),
            Expanded(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(title, style: const TextStyle(color: Colors.white, fontWeight: FontWeight.w900)),
                  const SizedBox(height: 3),
                  Text(subtitle, style: TextStyle(color: Colors.white.withOpacity(.65), fontWeight: FontWeight.w600)),
                ],
              ),
            ),
            Icon(Icons.chevron_right, color: Colors.white.withOpacity(.6)),
          ],
        ),
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: AppTheme.bg,
      appBar: AppBar(
        backgroundColor: AppTheme.bg,
        elevation: 0,
        title: const Text('Modo Industrial'),
        actions: [
          IconButton(
            tooltip: 'Trocar modo',
            onPressed: () => _switchMode(context),
            icon: const Icon(Icons.swap_horiz),
          ),
        ],
      ),
      body: ListView(
        padding: const EdgeInsets.all(16),
        children: [
          Text('Painel Industrial', style: TextStyle(color: Colors.white.withOpacity(.9), fontWeight: FontWeight.w900)),
          const SizedBox(height: 10),

          _tile(
            context: context,
            icon: Icons.warning_amber_rounded,
            title: 'LINHA PAROU ðŸš¨ (RelatÃ³rio rÃ¡pido)',
            subtitle: 'Preenche e jÃ¡ copia o relatÃ³rio.',
            onTap: () => _go(context, const LineStopScreen()),
          ),
          _tile(
            context: context,
            icon: Icons.sensors_outlined,
            title: 'DiagnÃ³stico por sintoma',
            subtitle: 'Ãrvore rÃ¡pida: sensor, inversor, motor...',
            onTap: () => _go(context, const DiagnosisScreen()),
          ),
          _tile(
            context: context,
            icon: Icons.menu_book_outlined,
            title: 'Falhas recorrentes',
            subtitle: 'Base de conhecimento: problema â†’ soluÃ§Ã£o.',
            onTap: () => _go(context, const KnowledgeBaseScreen()),
          ),
          _tile(
            context: context,
            icon: Icons.checklist_outlined,
            title: 'Checklists & LOTO',
            subtitle: 'Templates + histÃ³rico.',
            onTap: () => _go(context, const ChecklistsScreen()),
          ),
        ],
      ),
    );
  }
}
